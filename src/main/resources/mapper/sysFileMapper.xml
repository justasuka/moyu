<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="top.cfl.cflwork.dao.SysFileDao">
    <!--########################################################generated code start,do not update################################################################-->
    <sql id="projection">
        <choose>
             <when test="pager!=null and pager.includes!=null">
                 <foreach collection="pager.includes" item="field" separator=",">
                     T.${@cn.hutool.core.util.StrUtil@toUnderlineCase(field)}
                 </foreach>
             </when>
             <when test="pager!=null and pager.excludes!=null">
                 <trim suffixOverrides=",">
                         <if test="!pager.excludes.contains('id')">
                             T.id,
                         </if>
                         <if test="!pager.excludes.contains('type')">
                             T.`type`,
                         </if>
                         <if test="!pager.excludes.contains('title')">
                             T.title,
                         </if>
                         <if test="!pager.excludes.contains('parentId')">
                             T.parentId,
                         </if>
                         <if test="!pager.excludes.contains('path')">
                             T.path,
                         </if>
                         <if test="!pager.excludes.contains('tag')">
                             T.tag,
                         </if>
                         <if test="!pager.excludes.contains('shape')">
                             T.shape,
                         </if>
                         <if test="!pager.excludes.contains('width')">
                             T.width,
                         </if>
                         <if test="!pager.excludes.contains('height')">
                             T.height,
                         </if>
                         <if test="!pager.excludes.contains('size')">
                             T.`size`,
                         </if>
                         <if test="!pager.excludes.contains('suffix')">
                             T.suffix,
                         </if>
                         <if test="!pager.excludes.contains('description')">
                             T.description,
                         </if>
                         <if test="!pager.excludes.contains('address')">
                             T.address,
                         </if>
                         <if test="!pager.excludes.contains('adminId')">
                             T.admin_id,
                         </if>
                         <if test="!pager.excludes.contains('adminName')">
                             T.admin_name,
                         </if>
                         <if test="!pager.excludes.contains('level')">
                             T.`level`,
                         </if>
                         <if test="!pager.excludes.contains('score')">
                             T.score,
                         </if>
                         <if test="!pager.excludes.contains('createTime')">
                             T.create_time,
                         </if>
                         <if test="!pager.excludes.contains('isDelete')">
                             T.is_delete,
                         </if>
                         <if test="!pager.excludes.contains('updateTime')">
                             T.update_time,
                         </if>
                         <if test="!pager.excludes.contains('openTime')">
                             T.open_time,
                         </if>
                         <if test="!pager.excludes.contains('remark')">
                             T.remark,
                         </if>
                         <if test="!pager.excludes.contains('shootingTime')">
                             T.shooting_time,
                         </if>
                 </trim>
             </when>
             <otherwise>
                 T.*
             </otherwise>
         </choose>
    </sql>
    <sql id="match">
        <where>
              <if test="id!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('id')">
                            <trim suffixOverrides=",">
                                 T.id like concat('%',#{id},'%')
                            </trim>
                         </when>
                         <otherwise>
                             T.id=#{id}
                         </otherwise>
                      </choose>
              </if>
              <if test="type!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('type')">
                            <trim suffixOverrides=",">
                                and T.`type` like concat('%',#{type},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.`type`=#{type}
                         </otherwise>
                      </choose>
              </if>
              <if test="title!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('title')">
                            <trim suffixOverrides=",">
                                and T.title like concat('%',#{title},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.title=#{title}
                         </otherwise>
                      </choose>
              </if>
              <if test="parentId!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('parentId')">
                            <trim suffixOverrides=",">
                                and T.parentId like concat('%',#{parentId},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.parentId=#{parentId}
                         </otherwise>
                      </choose>
              </if>
              <if test="path!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('path')">
                            <trim suffixOverrides=",">
                                and T.path like concat('%',#{path},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.path=#{path}
                         </otherwise>
                      </choose>
              </if>
              <if test="tag!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('tag')">
                            <trim suffixOverrides=",">
                                and T.tag like concat('%',#{tag},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.tag=#{tag}
                         </otherwise>
                      </choose>
              </if>
              <if test="shape!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('shape')">
                            <trim suffixOverrides=",">
                                and T.shape like concat('%',#{shape},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.shape=#{shape}
                         </otherwise>
                      </choose>
              </if>
              <if test="width!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('width')">
                            <trim suffixOverrides=",">
                                and T.width like concat('%',#{width},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.width=#{width}
                         </otherwise>
                      </choose>
              </if>
              <if test="height!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('height')">
                            <trim suffixOverrides=",">
                                and T.height like concat('%',#{height},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.height=#{height}
                         </otherwise>
                      </choose>
              </if>
              <if test="size!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('size')">
                            <trim suffixOverrides=",">
                                and T.`size` like concat('%',#{size},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.`size`=#{size}
                         </otherwise>
                      </choose>
              </if>
              <if test="suffix!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('suffix')">
                            <trim suffixOverrides=",">
                                and T.suffix like concat('%',#{suffix},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.suffix=#{suffix}
                         </otherwise>
                      </choose>
              </if>
              <if test="description!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('description')">
                            <trim suffixOverrides=",">
                                and T.description like concat('%',#{description},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.description=#{description}
                         </otherwise>
                      </choose>
              </if>
              <if test="address!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('address')">
                            <trim suffixOverrides=",">
                                and T.address like concat('%',#{address},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.address=#{address}
                         </otherwise>
                      </choose>
              </if>
              <if test="adminId!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('adminId')">
                            <trim suffixOverrides=",">
                                and T.admin_id like concat('%',#{adminId},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.admin_id=#{adminId}
                         </otherwise>
                      </choose>
              </if>
              <if test="adminName!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('adminName')">
                            <trim suffixOverrides=",">
                                and T.admin_name like concat('%',#{adminName},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.admin_name=#{adminName}
                         </otherwise>
                      </choose>
              </if>
              <if test="level!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('level')">
                            <trim suffixOverrides=",">
                                and T.`level` like concat('%',#{level},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.`level`=#{level}
                         </otherwise>
                      </choose>
              </if>
              <if test="score!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('score')">
                            <trim suffixOverrides=",">
                                and T.score like concat('%',#{score},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.score=#{score}
                         </otherwise>
                      </choose>
              </if>


              <if test="isDelete!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('isDelete')">
                            <trim suffixOverrides=",">
                                and T.is_delete like concat('%',#{isDelete},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.is_delete=#{isDelete}
                         </otherwise>
                      </choose>
              </if>
              <if test="updateTime!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('updateTime')">
                            <trim suffixOverrides=",">
                                and T.update_time like concat('%',#{updateTime},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.update_time=#{updateTime}
                         </otherwise>
                      </choose>
              </if>
              <if test="openTime!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('openTime')">
                            <trim suffixOverrides=",">
                                and T.open_time like concat('%',#{openTime},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.open_time=#{openTime}
                         </otherwise>
                      </choose>
              </if>
              <if test="remark!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('remark')">
                            <trim suffixOverrides=",">
                                and T.remark like concat('%',#{remark},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.remark=#{remark}
                         </otherwise>
                      </choose>
              </if>
              <if test="shootingTime!=null">
                    <choose>
                         <when test="pager!=null and pager.like!=null and pager.like.contains('shootingTime')">
                            <trim suffixOverrides=",">
                                and T.shooting_time like concat('%',#{shootingTime},'%')
                            </trim>
                         </when>
                         <otherwise>
                            and T.shooting_time=#{shootingTime}
                         </otherwise>
                      </choose>
              </if>
            <if test="pager!=null and pager.rangeField!=null and pager.rangeArray!=null and pager.rangeArray.length==2">
                <foreach collection="pager.rangeArray" item="item"  index="i">
                    <if test="i==0 and item!=null">
                        and ${@cn.hutool.core.util.StrUtil@toUnderlineCase(pager.rangeField)} &gt;= #{item}
                    </if>
                    <if test="i==1 and item!=null">
                        and ${@cn.hutool.core.util.StrUtil@toUnderlineCase(pager.rangeField)} &lt;= #{item}
                    </if>
                </foreach>

            </if>
        </where>
    </sql>
    <sql id="sort">
        <if test="pager!=null and pager.sortField!=null and pager.sortOrder!=null">
            order by
            <foreach collection="pager.sortField.split(',')" item="s" index="i" separator=",">
                T.${@cn.hutool.core.util.StrUtil@toUnderlineCase(s)} ${pager.sortOrder.split(',')[i]}
            </foreach>
        </if>
    </sql>
    <sql id="page">
        <if test="pager!=null and  pager.paging">
            limit #{pager.beginRow},#{pager.pageSize}
        </if>
    </sql>
    <select id="findSysFileListByCondition" parameterType="SysFile" resultType="SysFile">
        select
        <include refid="projection"/>from sys_file T
        <include refid="match"/>
         <include refid="sort"/>
         <include refid="page"/>

    </select>

    <select id="findSysFileAllList" parameterType="SysFile" resultType="SysFile">
            select
             <include refid="projection"/>
             from sys_file T
             <include refid="match"/>
             <include refid="sort"/>
        </select>

    <select id="findSysFileCountByCondition" parameterType="SysFile" resultType="long">
        select count(*) from sys_file T
        <include refid="match"/>
    </select>
    <select id="findSysFileById" resultType="SysFile">
        select * from sys_file where id=#{id}
    </select>
    <select id="findOneSysFileByCondition" parameterType="SysFile" resultType="SysFile">
        select
         <include refid="projection"/>
         from sys_file T
        <include refid="match"/>
    </select>
    <insert id="saveSysFile" parameterType="SysFile">
        replace into sys_file
         (
            id,
            `type`,
            title,
            parentId,
            path,
            tag,
            shape,
            width,
            height,
            `size`,
            suffix,
            description,
            address,
            admin_id,
            admin_name,
            `level`,
            score,
            create_time,
            is_delete,
            update_time,
            open_time,
            remark,
            shooting_time
        ) values
         (
                #{id}
                ,
                #{type}
                ,
                #{title}
                ,
                #{parentId}
                ,
                #{path}
                ,
                #{tag}
                ,
                #{shape}
                ,
                #{width}
                ,
                #{height}
                ,
                #{size}
                ,
                #{suffix}
                ,
                #{description}
                ,
                #{address}
                ,
                #{adminId}
                ,
                #{adminName}
                ,
                #{level}
                ,
                #{score}
                ,
                now()
                ,
                #{isDelete}
                ,
                #{updateTime}
                ,
                #{openTime}
                ,
                #{remark}
                ,
                #{shootingTime}
                
         )
    </insert>
    <update id="updateSysFile" parameterType="SysFile">
        update sys_file
        <set>
                    <if test="type!=null ">
                        `type`=#{type},
                    </if>
                    <if test="title!=null ">
                        title=#{title},
                    </if>
                    <if test="parentId!=null ">
                        parentId=#{parentId},
                    </if>
                    <if test="path!=null ">
                        path=#{path},
                    </if>
                    <if test="tag!=null ">
                        tag=#{tag},
                    </if>
                    <if test="shape!=null ">
                        shape=#{shape},
                    </if>
                    <if test="width!=null ">
                        width=#{width},
                    </if>
                    <if test="height!=null ">
                        height=#{height},
                    </if>
                    <if test="size!=null ">
                        `size`=#{size},
                    </if>
                    <if test="suffix!=null ">
                        suffix=#{suffix},
                    </if>
                    <if test="description!=null ">
                        description=#{description},
                    </if>
                    <if test="address!=null ">
                        address=#{address},
                    </if>
                    <if test="adminId!=null ">
                        admin_id=#{adminId},
                    </if>
                    <if test="adminName!=null ">
                        admin_name=#{adminName},
                    </if>
                    <if test="level!=null ">
                        `level`=#{level},
                    </if>
                    <if test="score!=null ">
                        score=#{score},
                    </if>
                    <if test="createTime!=null ">
                        create_time=#{createTime},
                    </if>
                    <if test="isDelete!=null ">
                        is_delete=#{isDelete},
                    </if>
                    update_time=now(),
                    <if test="openTime!=null ">
                        open_time=#{openTime},
                    </if>
                    <if test="remark!=null ">
                        remark=#{remark},
                    </if>
                    <if test="shootingTime!=null ">
                        shooting_time=#{shootingTime}
                    </if>
          </set>
         where id=#{id}
    </update>
    <delete id="deleteSysFile" >
        delete from sys_file where id=#{id}
    </delete>
    <delete id="deleteSysFileByCondition" >
        delete T from sys_file T
        <include refid="match"/>
    </delete>
    <insert id="batchSaveSysFile" parameterType="SysFile">
        replace INTO sys_file (  id,  `type`,  title,  parentId,  path,  tag,  shape,  width,  height,  `size`,  suffix,  description,  address,  admin_id,  admin_name,  `level`,  score,  create_time,  is_delete,  update_time,  open_time,  remark,  shooting_time )
        VALUES
        <foreach collection="list" item="sysFile" separator=",">
            (  #{sysFile.id},  #{sysFile.type},  #{sysFile.title},  #{sysFile.parentId},  #{sysFile.path},  #{sysFile.tag},  #{sysFile.shape},  #{sysFile.width},  #{sysFile.height},  #{sysFile.size},  #{sysFile.suffix},  #{sysFile.description},  #{sysFile.address},  #{sysFile.adminId},  #{sysFile.adminName},  #{sysFile.level},  #{sysFile.score},  #{sysFile.createTime},  #{sysFile.isDelete},  #{sysFile.updateTime},  #{sysFile.openTime},  #{sysFile.remark},  #{sysFile.shootingTime}  )
        </foreach>
    </insert>
    <delete id="batchDeleteSysFile" parameterType="string">
        delete from sys_file where id in
        <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
            #{rowData}
        </foreach>
    </delete>
    <update id="batchUpdateSysFile" parameterType="SysFile">
        update sys_file
        <set>
                    <if test="type!=null ">
                        `type`=#{type},
                    </if>
                    <if test="title!=null ">
                        title=#{title},
                    </if>
                    <if test="parentId!=null ">
                        parentId=#{parentId},
                    </if>
                    <if test="path!=null ">
                        path=#{path},
                    </if>
                    <if test="tag!=null ">
                        tag=#{tag},
                    </if>
                    <if test="shape!=null ">
                        shape=#{shape},
                    </if>
                    <if test="width!=null ">
                        width=#{width},
                    </if>
                    <if test="height!=null ">
                        height=#{height},
                    </if>
                    <if test="size!=null ">
                        `size`=#{size},
                    </if>
                    <if test="suffix!=null ">
                        suffix=#{suffix},
                    </if>
                    <if test="description!=null ">
                        description=#{description},
                    </if>
                    <if test="address!=null ">
                        address=#{address},
                    </if>
                    <if test="adminId!=null ">
                        admin_id=#{adminId},
                    </if>
                    <if test="adminName!=null ">
                        admin_name=#{adminName},
                    </if>
                    <if test="level!=null ">
                        `level`=#{level},
                    </if>
                    <if test="score!=null ">
                        score=#{score},
                    </if>
                    <if test="createTime!=null ">
                        create_time=#{createTime},
                    </if>
                    <if test="isDelete!=null ">
                        is_delete=#{isDelete},
                    </if>
                    update_time=now(),
                    <if test="openTime!=null ">
                        open_time=#{openTime},
                    </if>
                    <if test="remark!=null ">
                        remark=#{remark},
                    </if>
                    <if test="shootingTime!=null ">
                        shooting_time=#{shootingTime}
                    </if>
          </set>
         where id in
           <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
               #{rowData}
           </foreach>
    </update>
    <select id="getSysFileTableField" resultType="ExcelExport">
            select column_name as 'key',column_comment as 'name' from information_schema.columns where table_name='sys_file'
            <!--####### 如果有多个数据库的表一致的情况下，需要加上此标签，例如 archives and table_schema = 'archives' #########-->
        </select>
    <!--##################################################generated code end,do not update######################################################################-->
    <!--查找当前id及其下级所有id-->
    <select id="getSysFileChildrenList" resultType="java.lang.String">
        SELECT
            group_concat( T1._id ) AS id
        FROM
            (
        SELECT
            @r AS _id,
            ( SELECT @r := group_concat( t.id ) FROM sys_file t WHERE FIND_IN_SET ( t.parentId, _id ) ) AS parentId,
            @l := @l + 1 AS lvl
        FROM
            ( SELECT @r := #{id},@l:=0 ) vars,
            sys_file h
        WHERE
            @r is not null
            ) T1
    </select>


    <update id="updateSysFileWithOutUpdatetime" parameterType="SysFile">
        update sys_file
        <set>
            <if test="type!=null ">
                `type`=#{type},
            </if>
            <if test="title!=null ">
                title=#{title},
            </if>
            <if test="parentId!=null ">
                parentId=#{parentId},
            </if>
            <if test="path!=null ">
                path=#{path},
            </if>
            <if test="tag!=null ">
                tag=#{tag},
            </if>
            <if test="shape!=null ">
                shape=#{shape},
            </if>
            <if test="width!=null ">
                width=#{width},
            </if>
            <if test="height!=null ">
                height=#{height},
            </if>
            <if test="size!=null ">
                `size`=#{size},
            </if>
            <if test="suffix!=null ">
                suffix=#{suffix},
            </if>
            <if test="description!=null ">
                description=#{description},
            </if>
            <if test="address!=null ">
                address=#{address},
            </if>
            <if test="adminId!=null ">
                admin_id=#{adminId},
            </if>
            <if test="adminName!=null ">
                admin_name=#{adminName},
            </if>
            <if test="level!=null ">
                `level`=#{level},
            </if>
            <if test="score!=null ">
                score=#{score},
            </if>
            <if test="createTime!=null ">
                create_time=#{createTime},
            </if>
            <if test="isDelete!=null ">
                is_delete=#{isDelete},
            </if>

            <if test="openTime!=null ">
                open_time=#{openTime},
            </if>
            <if test="remark!=null ">
                remark=#{remark},
            </if>
            <if test="shootingTime!=null ">
                shooting_time=#{shootingTime}
            </if>
        </set>
        where id=#{id}
    </update>
    <select id="findSysFileAllbyPath"  resultType="SysFile">
        select
        *
        from sys_file T
        where T.path like concat(#{path},'/%') and T.type='0'   order by T.path
    </select>
    <select id="findSysFileAllWithoutStatus"  resultType="SysFile">
        select
        *
        from sys_file T
        where T.path like concat(#{path},'/%')
    </select>
    <select id="findSysFileOpenTime"  resultType="SysFile">
        select
        *
        from sys_file T
        where T.is_delete='0'
        order by T.open_time desc limit 10
    </select>
    <sql id="role">
            <if test="type!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('type')">
                        <trim suffixOverrides=",">
                            and T.`type` like concat('%',#{type},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.`type`=#{type}
                    </otherwise>
                </choose>
            </if>
            <if test="title!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('title')">
                        <trim suffixOverrides=",">
                            and T.title like concat('%',#{title},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.title=#{title}
                    </otherwise>
                </choose>
            </if>
            <if test="parentId!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('parentId')">
                        <trim suffixOverrides=",">
                            and T.parentId like concat('%',#{parentId},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.parentId=#{parentId}
                    </otherwise>
                </choose>
            </if>
            <if test="path!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('path')">
                        <trim suffixOverrides=",">
                            and T.path like concat('%',#{path},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.path=#{path}
                    </otherwise>
                </choose>
            </if>
            <if test="address!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('address')">
                        <trim suffixOverrides=",">
                            and T.address like concat('%',#{address},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.address=#{address}
                    </otherwise>
                </choose>
            </if>
            <if test="adminId!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('adminId')">
                        <trim suffixOverrides=",">
                            and T.admin_id like concat('%',#{adminId},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.admin_id=#{adminId}
                    </otherwise>
                </choose>
            </if>
            <if test="adminName!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('adminName')">
                        <trim suffixOverrides=",">
                            and T.admin_name like concat('%',#{adminName},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.admin_name=#{adminName}
                    </otherwise>
                </choose>
            </if>
            <if test="isDelete!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('isDelete')">
                        <trim suffixOverrides=",">
                            and T.is_delete like concat('%',#{isDelete},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.is_delete=#{isDelete}
                    </otherwise>
                </choose>
            </if>
            <if test="shootingTime!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('shootingTime')">
                        <trim suffixOverrides=",">
                            and T.shooting_time like concat('%',#{shootingTime},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.shooting_time=#{shootingTime}
                    </otherwise>
                </choose>
            </if>
            <if test="pager!=null and pager.rangeField!=null and pager.rangeArray!=null and pager.rangeArray.length==2">
                <foreach collection="pager.rangeArray" item="item"  index="i">
                    <if test="i==0 and item!=null">
                        and ${@cn.hutool.core.util.StrUtil@toUnderlineCase(pager.rangeField)} &gt;= #{item}
                    </if>
                    <if test="i==1 and item!=null">
                        and ${@cn.hutool.core.util.StrUtil@toUnderlineCase(pager.rangeField)} &lt;= #{item}
                    </if>
                </foreach>

            </if>
    </sql>
    <select id="findSysFileListByRole" parameterType="SysFile" resultType="SysFile">
        select
        <include refid="projection"/>
        from sys_file T
        where T.address IN (
        SELECT T1.path FROM `sys_file` T1 where T1.id in
        (select T2.sys_file_id from sys_file_role t2 WHERE T2.sys_file_parent_id != "-1")
        )
        <include refid="role"/>
        <include refid="sort"/>
        <include refid="page"/>

    </select>

    <select id="findSysFileCountByRole" parameterType="SysFile" resultType="long">
        select count(*) from sys_file T
        where T.address IN (
        SELECT T1.path FROM `sys_file`  T1  where   T1.id in
        (select T2.sys_file_id from sys_file_role t2 WHERE T2.sys_file_parent_id != "-1")
        )
        <include refid="role"/>
    </select>
    <select id="findSysFileCountByDate" parameterType="Integer" resultType="long">
       select count(*) from sys_file T
         where T.create_time>  DATE_SUB(now(),INTERVAL #{num} DAY)

    </select>
    <select id="findSysFileCountByMonth"  resultType="java.util.Map">
         (select DATE_FORMAT (T.create_time,'%Y-%m') as month , count(*) as count
          from sys_file T where T.is_delete='0' and T.create_time is not null
          group by month order by month) ORDER BY month DESC limit 6
    </select>


    <select id="findSysFileListByConditionRecycleBin" parameterType="SysFile" resultType="SysFile">
        select
        <include refid="projection"/> from sys_file T
        where T.is_delete='1' or T.is_delete='9'
        <include refid="sort"/>
        <include refid="page"/>
    </select>

    <select id="findCountByConditionRecycleBin" parameterType="SysFile" resultType="long">
        select
        count(*) from sys_file T
        where T.is_delete='1' or T.is_delete='9'
    </select>

    <select id="findSysFileListByRecycleBinRole" parameterType="SysFile" resultType="SysFile">
        select DISTINCT  * from (select
        * from sys_file T2
        where T2.is_delete='1' or T2.is_delete='9'
        )T
        <if test="rolePath!=null and rowData!=null">
            where
              T.address in
            <foreach item="rolePath" collection="rolePath" open="(" separator="," close=")">
                #{rolePath}
            </foreach>
              or T.path in
            <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
                  #{rowData}
              </foreach>
        </if>
        <if test="rowData=null ">
            where
            T.address in
            <foreach item="rolePath" collection="rolePath" open="(" separator="," close=")">
                #{rolePath}
            </foreach>
        </if>
        <if test="rolePath=null ">
            where
            T.path in
            <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
                #{rowData}
            </foreach>
        </if>
        <include refid="sort"/>
        <include refid="page"/>
    </select>
    <select id="findCountByRecycleBinRole" parameterType="SysFile" resultType="long">
        select DISTINCT  count(*)  from (select
        * from sys_file T2
        where T2.is_delete='1' or T2.is_delete='9'
        )T
        <if test="rolePath!=null and rowData!=null">
            where
            T.address in
            <foreach item="rolePath" collection="rolePath" open="(" separator="," close=")">
                #{rolePath}
            </foreach>
            or T.path in
            <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
                #{rowData}
            </foreach>
        </if>
        <if test="rowData=null ">
            where
            T.address in
            <foreach item="rolePath" collection="rolePath" open="(" separator="," close=")">
                #{rolePath}
            </foreach>
        </if>
        <if test="rolePath=null ">
            where
            T.path in
            <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
                #{rowData}
            </foreach>
        </if>
    </select>

    <select id="findSysFileListByINStatus" parameterType="SysFile" resultType="SysFile">
        select
        <include refid="projection"/>from sys_file T
        <include refid="match2"/>
        <include refid="sort"/>
        <include refid="page"/>

    </select>
    <select id="findSysFileCountByINStatus" parameterType="SysFile" resultType="long">
        select count(*) from sys_file T
        <include refid="match2"/>
    </select>
    <sql id="match2">
        <where>
            <if test="id!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('id')">
                        <trim suffixOverrides=",">
                            T.id like concat('%',#{id},'%')
                        </trim>
                    </when>
                    <otherwise>
                        T.id=#{id}
                    </otherwise>
                </choose>
            </if>
            <if test="type!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('type')">
                        <trim suffixOverrides=",">
                            and T.`type` like concat('%',#{type},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.`type`=#{type}
                    </otherwise>
                </choose>
            </if>
            <if test="title!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('title')">
                        <trim suffixOverrides=",">
                            and T.title like concat('%',#{title},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.title=#{title}
                    </otherwise>
                </choose>
            </if>
            <if test="parentId!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('parentId')">
                        <trim suffixOverrides=",">
                            and T.parentId like concat('%',#{parentId},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.parentId=#{parentId}
                    </otherwise>
                </choose>
            </if>
            <if test="path!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('path')">
                        <trim suffixOverrides=",">
                            and T.path like concat('%',#{path},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.path=#{path}
                    </otherwise>
                </choose>
            </if>
            <if test="tag!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('tag')">
                        <trim suffixOverrides=",">
                            and T.tag like concat('%',#{tag},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.tag=#{tag}
                    </otherwise>
                </choose>
            </if>
            <if test="shape!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('shape')">
                        <trim suffixOverrides=",">
                            and T.shape like concat('%',#{shape},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.shape=#{shape}
                    </otherwise>
                </choose>
            </if>
            <if test="width!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('width')">
                        <trim suffixOverrides=",">
                            and T.width like concat('%',#{width},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.width=#{width}
                    </otherwise>
                </choose>
            </if>
            <if test="height!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('height')">
                        <trim suffixOverrides=",">
                            and T.height like concat('%',#{height},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.height=#{height}
                    </otherwise>
                </choose>
            </if>
            <if test="size!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('size')">
                        <trim suffixOverrides=",">
                            and T.`size` like concat('%',#{size},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.`size`=#{size}
                    </otherwise>
                </choose>
            </if>
            <if test="suffix!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('suffix')">
                        <trim suffixOverrides=",">
                            and T.suffix like concat('%',#{suffix},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.suffix=#{suffix}
                    </otherwise>
                </choose>
            </if>
            <if test="description!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('description')">
                        <trim suffixOverrides=",">
                            and T.description like concat('%',#{description},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.description=#{description}
                    </otherwise>
                </choose>
            </if>
            <if test="address!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('address')">
                        <trim suffixOverrides=",">
                            and T.address like concat('%',#{address},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.address=#{address}
                    </otherwise>
                </choose>
            </if>
            <if test="adminId!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('adminId')">
                        <trim suffixOverrides=",">
                            and T.admin_id like concat('%',#{adminId},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.admin_id=#{adminId}
                    </otherwise>
                </choose>
            </if>
            <if test="adminName!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('adminName')">
                        <trim suffixOverrides=",">
                            and T.admin_name like concat('%',#{adminName},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.admin_name=#{adminName}
                    </otherwise>
                </choose>
            </if>
            <if test="level!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('level')">
                        <trim suffixOverrides=",">
                            and T.`level` like concat('%',#{level},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.`level`=#{level}
                    </otherwise>
                </choose>
            </if>
            <if test="score!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('score')">
                        <trim suffixOverrides=",">
                            and T.score like concat('%',#{score},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.score=#{score}
                    </otherwise>
                </choose>
            </if>


            <if test="isDelete!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('isDelete')">
                        <trim suffixOverrides=",">
                            and T.is_delete like concat('%',#{isDelete},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.is_delete in
                        <foreach item="rowData" collection="rowData" open="(" separator="," close=")">
                            #{rowData}
                        </foreach>
                    </otherwise>
                </choose>
            </if>
            <if test="updateTime!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('updateTime')">
                        <trim suffixOverrides=",">
                            and T.update_time like concat('%',#{updateTime},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.update_time=#{updateTime}
                    </otherwise>
                </choose>
            </if>
            <if test="openTime!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('openTime')">
                        <trim suffixOverrides=",">
                            and T.open_time like concat('%',#{openTime},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.open_time=#{openTime}
                    </otherwise>
                </choose>
            </if>
            <if test="remark!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('remark')">
                        <trim suffixOverrides=",">
                            and T.remark like concat('%',#{remark},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.remark=#{remark}
                    </otherwise>
                </choose>
            </if>
            <if test="shootingTime!=null">
                <choose>
                    <when test="pager!=null and pager.like!=null and pager.like.contains('shootingTime')">
                        <trim suffixOverrides=",">
                            and T.shooting_time like concat('%',#{shootingTime},'%')
                        </trim>
                    </when>
                    <otherwise>
                        and T.shooting_time=#{shootingTime}
                    </otherwise>
                </choose>
            </if>
            <if test="pager!=null and pager.rangeField!=null and pager.rangeArray!=null and pager.rangeArray.length==2">
                <foreach collection="pager.rangeArray" item="item"  index="i">
                    <if test="i==0 and item!=null">
                        and ${@cn.hutool.core.util.StrUtil@toUnderlineCase(pager.rangeField)} &gt;= #{item}
                    </if>
                    <if test="i==1 and item!=null">
                        and ${@cn.hutool.core.util.StrUtil@toUnderlineCase(pager.rangeField)} &lt;= #{item}
                    </if>
                </foreach>

            </if>
        </where>
    </sql>
</mapper>